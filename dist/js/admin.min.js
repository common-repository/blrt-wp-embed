window.blrt_wp_admin_js_loaded=!0,jQuery(document).ready(function(l){function e(){for(var e="",a=n.find(".blrt-wp-url-single .blrt-link"),t=n.find(".blrt-wp-url-single h4"),i=n.find(".blrt-wp-url-single .fallback-title"),r=0;r<a.length;r++)e+=l(a[r]).attr("href")+"+"+l(t[r]).text()+"+"+l(i[r]).attr("href")+",";o.val(e),l(".blrt_page_blrt-add-gallery .blrt-embed-plugin > form").trigger("checkform.areYouSure")}l("#footer-thankyou").text("Contact us at support@blrt.com");var a=l(".blrt-embed-plugin"),t=a.find("#blrt-embed-link-input"),i=[],n=a.find("#blrt-embed-url-placeholder"),r=a.find(".message-add-new-link"),s=a.find(".button-add-new-link"),c=a.find('input[name="publish"]');l('input[name="master-checkbox"]').click(function(){l(this).is(":checked")?l('input[name="checkbox"]').attr("checked",!0):l('input[name="checkbox"]').attr("checked",!1)}),l("#blrt-embed-url-placeholder").sortable({axis:"y",containment:a,items:"> li",handle:".dragbox",change:function(){e()}}),l(".blrt_page_blrt-add-gallery .blrt-embed-plugin > form").areYouSure();var o=a.find('#blrt-embed-url-placeholder input[name="url"]');s.on("click",function(){if(l(".blrt-wp-url-single").length>=20)alert("Max Blrts for a gallery is 20.");else{var s=a.find(".container-add-new-gallery .spinner"),c=t.val();if(""!=c){var o=/https?:\/\/(?:[^\.]+\.)?blrt\.com\/([^\?]+)/.exec(c);if(o){c=o[1];var d=/blrt\/([a-zA-Z0-9]+)/.exec(c);d?(d=d[1],s.css("visibility","visible"),l.ajax({method:"GET",url:"https://m.blrt.co/blrt/"+d+".json",dataType:"jsonp",crossDomain:!0,success:function(a){a.success?(i.push(a.data),i[i.length-1].id=d,n.append("<li class='blrt-wp-url-single'><div class='dragbox'><div class='blrt-disp-table'><div class='blrt-disp-table-cell'><span class='dashicons dashicons-menu dragger'></span></div></div></div><div class='blrt-main'><div class='row row-1'><div class='col-title'><span class='blrt-counter'></span><a class='blrt-title-link blrt-link' href='https://e.blrt.com/embed/blrt/"+d+"' target='_blank'><h4>"+a.data.title+"</h4></a></div><div class='col-copy'><a href='#copy' class='blrt-url' data-url='https://e.blrt.com/embed/blrt/"+d+"'>[Copy link]</a></div></div><div class='row row-2 fallback-section'><span class='fallback-text'>Fallback video:&nbsp;</span><a class='fallback-title' href=''></a>&nbsp;<a class='fallback-link' href='#fallback'>[Add]</a></div><div class='row row-3'><div class='blrt-popup hidden'><hr/><div class='blrt-disp-table'><div class='blrt-disp-table-cell blrt-popup-inner'><div class='blrt-popup-inner-inner'><div class='blrt-popup-section blrt-popup-copy'><input type='text' class='blrt-input' data-ays-ignore='true' data-selectall='true' value='https://e.blrt.com/embed/blrt/"+d+"' readonly/></div><div class='blrt-popup-section blrt-popup-fallback'><span class='fallback-field'><input data-ays-ignore='true' data-selectall='true' type='text' name='fallback_link' class='fallback-input' data-value='' value=''><a href='#cancel' class='fallback-cancel'>[Cancel]</a> <a href='#save' class='fallback-add'>[Save]</a> <a href='#remove' class='fallback-remove hidden'>[Remove]</a></span></div></div><a class='blrt-close' href='#close'>[Close]</a></div></div></div></div></div><div class='buttons'><div class='blrt-disp-table'><div class='blrt-disp-table-cell'><span class='dashicons dashicons-trash trash'></span><span class='dashicons dashicons-arrow-up-alt'></span><span class='dashicons dashicons-arrow-down-alt'></span></div></div></div></li>"),l(t).val(""),r.text("Blrt added."),e()):alert("Please ensure you are using an individual Blrt link, not a Blrt Conversation link."),s.css("visibility","hidden")},error:function(){alert("Failed to query data"),s.css("visibility","hidden")}})):alert("Please ensure you are using an individual Blrt link, not a Blrt Conversation link")}else alert("The link you have entered does not seem to be a Blrt link")}}}),c.on("click",function(a){l("body").hasClass("blrt_page_blrt-add-gallery")&&(""==l('.blrt-embed-plugin > form input[name="name"]').val()?(a.preventDefault(),alert("Please check that you have added a name to this gallery")):e())}),a.on("click touch tap",".trash",function(a){if(!confirm("Are you sure you want to remove this Blrt from the gallery?"))return a.preventDefault(),!1;l(a.target).closest("li").remove(),e()}),a.on("click",".dashicons-arrow-down-alt",function(a){var t=l(a.originalEvent.target).closest(".blrt-wp-url-single");t.not(":last-child")&&(t.next().after(t),e())}),a.on("click",".dashicons-arrow-up-alt",function(a){var t=l(a.originalEvent.target).closest(".blrt-wp-url-single");t.not(":first-child")&&(t.prev().before(t),e())}),a.on("focus",'textarea[data-selectall="true"], input[data-selectall="true"]',function(e){var a=l(this);a.select(),a.mouseup(function(){return a.unbind("mouseup"),!1})}),a.on("click",".blrt-close",function(e){e.preventDefault();var a=l(this),t=l(".blrt-popup",a.closest("li"));t.slideUp(),l(".blrt-popup-section",t).hide()}),a.on("click",".blrt-url",function(e){e.preventDefault();var a=l(this),t=l(".blrt-popup",a.closest("li"));l(".blrt-popup-section",t).hide(),l(".blrt-close",t).show();var i=l(".blrt-popup-copy",t),n=l(".blrt-input",i);i.show(),t.slideDown(),n.focus(),n.select()}),a.on("click",".fallback-link",function(e){e.preventDefault();var a=l(this),t=l(".blrt-popup",a.closest("li"));l(".blrt-popup-section",t).hide(),l(".blrt-close",t).hide(),l(".blrt-popup-fallback",t).show(),t.slideDown()}),a.on("click",".fallback-add",function(a){a.preventDefault();var t=l(a.originalEvent.target).parent().find('input[name="fallback_link"]'),i=l(a.originalEvent.target).closest(".blrt-wp-url-single");if(""!=t.val()){if(!/https?:\/\/.*/.exec(t.val()))return void alert("Please enter a valid http/https URL");i.find(".fallback-link").text("[Edit]"),i.find(".fallback-remove").removeClass("hidden"),i.find(".fallback-title").text(t.val()).attr("href",t.val())}else i.find(".fallback-remove").addClass("hidden"),i.find(".fallback-link").text("[Add]"),i.find(".fallback-title").text("").attr("href","");t.data("value",t.val());var n=l(this),r=l(".blrt-popup",n.closest("li"));r.slideUp(),l(".blrt-popup-section",r).hide(),e()}),a.on("click",".fallback-remove",function(a){a.preventDefault();var t=l(a.originalEvent.target).parent().find('input[name="fallback_link"]'),i=l(a.originalEvent.target).closest(".blrt-wp-url-single");i.find(".fallback-remove").addClass("hidden"),i.find(".fallback-link").text("[Add]"),i.find(".fallback-title").text("").attr("href",""),t.val(""),t.data("value","");var n=l(this),r=l(".blrt-popup",n.closest("li"));r.slideUp(),l(".blrt-popup-section",r).hide(),e()}),a.on("click",".fallback-cancel",function(e){e.preventDefault();var a=l(this),t=l(".blrt-popup",a.closest("li"));l(".fallback-input",t).val(l(".fallback-input",t).data("value")),t.slideUp(),l(".blrt-popup-section",t).hide()}),a.on("click","#debug-open",function(){l("#debug-open").hide(),l("#debug-container").slideDown()});var d=!1,p=!1,u=!1,b=!1;a.on("change","#shortcode-builder input",function(e){var a=l(this);"slider-position"!=a.attr("name")||d?"gallery-size"!=a.attr("name")||p?"gallery-skin"!=a.attr("name")||u?"mobile-view"!=a.attr("name")||b||(b=!0):u=!0:p=!0:d=!0;var t="[blrt-gallery";t+=' id="'+l("#gallery-id").val()+'"',d&&(t+=' position="'+l('input[name="slider-position"]:checked').val()+'"',l(".gallery-preview .p-gallery").removeClass("top bottom left right").addClass(l('input[name="slider-position"]:checked').val())),p&&(t+=' size="'+l('input[name="gallery-size"]:checked').val()+'"',l(".gallery-preview .p-gallery").removeClass("small medium large extra").addClass(l('input[name="gallery-size"]:checked').val())),u&&(t+=' skin="'+l('input[name="gallery-skin"]:checked').val()+'"',l(".p-gallery, .mobile-snippet").removeClass("light dark").addClass(l('input[name="gallery-skin"]:checked').val())),b&&(t+=' mobile="'+l('input[name="mobile-view"]:checked').val()+'"',l(".gallery-mobile").removeClass("video snippet").addClass(l('input[name="mobile-view"]:checked').val())),t+="]",l("#shortcode-output").text(t)})});
//# sourceMappingURL=admin.min.js.map
